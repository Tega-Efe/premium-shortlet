<div class="card" @fadeIn appHoverEffect="lift">
  <!-- Image Section -->
  <div class="card-image">
    <img 
      [src]="apartment().images[0] || 'placeholder.svg'"
      [alt]="apartment().title"
      class="image"
      appHoverEffect="scale"
    />
    
    <!-- Gradient Overlay -->
    <div class="image-overlay"></div>
    
    <!-- Status Badge -->
    @if (apartment().availability.status === 'booked') {
      <span class="badge badge-unavailable">
        <i class="fas fa-ban"></i>
        <span>Booked</span>
      </span>
    } @else if (apartment().availability.status === 'maintenance') {
      <span class="badge badge-maintenance">
        <i class="fas fa-tools"></i>
        <span>Maintenance</span>
      </span>
    } @else {
      <span class="badge badge-available">
        <i class="fas fa-check-circle"></i>
        <span>Available</span>
      </span>
    }
    
    <!-- Favorite Button -->
    <button class="favorite-btn" (click)="toggleFavorite($event)" [class.active]="isFavorite()" appHoverEffect="glow">
      <i [class]="isFavorite() ? 'fas fa-heart' : 'far fa-heart'"></i>
    </button>
  </div>

  <!-- Content Section -->
  <div class="card-content">
    <!-- Title and Location -->
    <div class="card-header">
      <h3 class="card-title">{{ apartment().title }}</h3>
      <p class="card-location">
        <i class="fas fa-location-dot"></i>
        <span>{{ apartment().location.city }}, {{ apartment().location.state }}</span>
      </p>
    </div>

    <!-- Specifications -->
    <div class="card-specs">
      <div class="spec">
        <i class="fas fa-bed"></i>
        <span>{{ apartment().specifications.bedrooms }}</span>
      </div>
      <div class="spec">
        <i class="fas fa-shower"></i>
        <span>{{ apartment().specifications.bathrooms }}</span>
      </div>
      <div class="spec">
        <i class="fas fa-users"></i>
        <span>{{ getMaxGuests() }}</span>
      </div>
    </div>

    <!-- Amenities -->
    @if (apartment().amenities && apartment().amenities.length > 0) {
      <div class="card-amenities">
        @for (amenity of getDisplayAmenities(); track amenity) {
          <span class="amenity-tag">
            <i [class]="getAmenityIcon(amenity)"></i>
            <span>{{ amenity }}</span>
          </span>
        }
        @if (apartment().amenities.length > 4) {
          <span class="amenity-tag more">
            <i class="fas fa-plus"></i>
            <span>{{ apartment().amenities.length - 4 }} more</span>
          </span>
        }
      </div>
    }

    <!-- Rating -->
    @if (apartment().rating) {
      <div class="card-rating">
        <div class="stars">
          @for (star of [1,2,3,4,5]; track star) {
            <i 
              class="fas fa-star" 
              [class.filled]="star <= (apartment().rating?.average || 0)"
            ></i>
          }
        </div>
        <span class="rating-value">{{ (apartment().rating?.average || 0).toFixed(1) }}</span>
        <span class="rating-count">({{ apartment().rating?.count || 0 }})</span>
      </div>
    }

    <!-- Price and Action -->
    <div class="card-footer">
      <div class="price-section">
        <span class="price">{{ getFormattedPrice() }}</span>
        <span class="price-period">/night</span>
      </div>
      
      <div class="card-actions">
        @if (showViewButton()) {
          <button 
            class="btn btn-secondary"
            (click)="onView($event)"
            appHoverEffect="glow"
          >
            <i class="fas fa-eye"></i>
            <span>Details</span>
          </button>
        }
        
        @if (showBookButton()) {
          <button 
            class="btn btn-primary"
            (click)="onBook($event)"
            [disabled]="apartment().availability.status !== 'available'"
            appHoverEffect="glow"
          >
            <i class="fas fa-calendar-check"></i>
            <span>{{ apartment().availability.status !== 'available' ? 'Unavailable' : 'Book Now' }}</span>
          </button>
        }
      </div>
    </div>
  </div>
</div>
