<div class="admin-page">
      <!-- Admin Header -->
      <div class="admin-header">
        <div class="header-background">
          <svg viewBox="0 0 1440 320" xmlns="http://www.w3.org/2000/svg">
            <path fill="rgba(212, 165, 116, 0.15)" d="M0,192 Q360,128 720,192 T1440,192 L1440,0 L0,0 Z"></path>
            <path fill="rgba(125, 25, 53, 0.1)" d="M0,160 Q360,96 720,160 T1440,160 L1440,0 L0,0 Z"></path>
          </svg>
        </div>
        <div class="container" appAnimateOnScroll="slide-up">
          <div class="header-content">
            <div class="header-top">
              <div class="header-left">
                <div class="header-badge">
                  <i class="fas fa-shield-alt"></i>
                  <span>Admin Portal</span>
                </div>
                <h1 class="page-title">
                  <i class="fas fa-th-large"></i>
                  Dashboard
                </h1>
                <p class="page-subtitle">Manage bookings and apartment availability for our Victoria Island property</p>
              </div>
              <div class="header-right">
                <div class="admin-info">
                  <div class="admin-avatar">
                    <i class="fas fa-user-shield"></i>
                  </div>
                  <div class="admin-details">
                    <span class="admin-name">{{ currentUserEmail() }}</span>
                    <button class="btn-logout" (click)="openLogoutModal()">
                      <i class="fas fa-sign-out-alt"></i>
                      <span>Sign Out</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <!-- Dashboard Stats -->
        <div class="stats-grid">
          <div class="stat-card" appAnimateOnScroll="slide-up" [delay]="0">
            <div class="stat-icon burgundy">
              <i class="fas fa-calendar-check"></i>
            </div>
            <div class="stat-content">
              <p class="stat-label">Total Bookings</p>
              <p class="stat-value">{{ stats().totalBookings }}</p>
              <div class="stat-trend positive">
                <i class="fas fa-calendar"></i>
                <span>All-time</span>
              </div>
            </div>
          </div>

          <div class="stat-card" appAnimateOnScroll="slide-up" [delay]="100">
            <div class="stat-icon gold">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
              <p class="stat-label">Pending Approvals</p>
              <p class="stat-value">{{ stats().pendingApprovals }}</p>
              <div class="stat-trend">
                <i class="fas fa-hourglass-half"></i>
                <span>{{ stats().pendingApprovals > 0 ? 'Needs review' : 'All clear' }}</span>
              </div>
            </div>
          </div>

          <div class="stat-card" appAnimateOnScroll="slide-up" [delay]="200">
            <div class="stat-icon success">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
              <p class="stat-label">Approved Today</p>
              <p class="stat-value">{{ stats().approvedToday }}</p>
              <div class="stat-trend positive">
                <i class="fas fa-thumbs-up"></i>
                <span>{{ stats().approvedToday > 0 ? 'Active' : 'None yet' }}</span>
              </div>
            </div>
          </div>

          <div class="stat-card" appAnimateOnScroll="slide-up" [delay]="300">
            <div class="stat-icon danger">
              <i class="fas fa-times-circle"></i>
            </div>
            <div class="stat-content">
              <p class="stat-label">Rejected Today</p>
              <p class="stat-value">{{ stats().rejectedToday }}</p>
              <div class="stat-trend">
                <i class="fas fa-ban"></i>
                <span>Processed</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Apartment Availability Control -->
        <div class="availability-control-card" appAnimateOnScroll="slide-up" [delay]="400">
          <div class="availability-header">
            <div class="availability-info">
              <h3 class="availability-title">
                <i class="fas fa-home"></i>
                Apartment Availability Management
              </h3>
              <p class="availability-description">
                Control which apartments are available for booking. Unavailable apartments will be hidden from the booking form on the homepage.
              </p>
            </div>
            <div class="availability-status" 
                 [class.available]="availableApartmentsCount() > 0" 
                 [class.unavailable]="availableApartmentsCount() === 0">
              <span class="status-indicator"></span>
              <span class="status-text">
                {{ availableApartmentsCount() }} of {{ apartments().length }} Available
              </span>
            </div>
          </div>
          <div class="availability-actions">
            <button 
              class="btn-manage-availability"
              [disabled]="isLoadingApartments()"
              (click)="openAvailabilityModal()"
            >
              <i class="fas fa-cog"></i>
              <span>Manage Availability</span>
            </button>
            <p class="availability-hint">
              <i class="fas fa-info-circle"></i>
              @if (availableApartmentsCount() === 0) {
                <span class="text-warning">⚠️ No apartments available - booking form is hidden</span>
              } @else {
                <span>{{ availableApartmentsCount() }} apartment(s) currently accepting bookings</span>
              }
            </p>
          </div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container" appAnimateOnScroll="fade-in">
          <div class="tabs">
            <button 
              class="tab"
              [class.active]="activeTab() === 'pending'"
              (click)="setActiveTab('pending')"
            >
              <i class="fas fa-clock"></i>
              <span>Pending Approvals</span>
              @if (pendingBookings().length > 0) {
                <span class="tab-badge">{{ pendingBookings().length }}</span>
              }
            </button>
            <button 
              class="tab"
              [class.active]="activeTab() === 'all'"
              (click)="setActiveTab('all')"
            >
              <i class="fas fa-list"></i>
              <span>All Bookings</span>
            </button>
            <button 
              class="tab"
              [class.active]="activeTab() === 'history'"
              (click)="setActiveTab('history')"
            >
              <i class="fas fa-history"></i>
              <span>Activity History</span>
            </button>
            <button 
              class="tab"
              [class.active]="activeTab() === 'listings'"
              (click)="setActiveTab('listings')"
            >
              <i class="fas fa-home-lg-alt"></i>
              <span>Manage Listing</span>
            </button>
          </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- Loading State -->
          @if (isLoading()) {
            <div class="loading-container">
              <app-loader />
            </div>
          }

          <!-- Pending Approvals Tab -->
          @else if (activeTab() === 'pending') {
            @if (pendingBookings().length > 0) {
              <div class="table-wrapper">
                <div class="table-header">
                  <h3 class="table-title">
                    <i class="fas fa-clipboard-list"></i>
                    Pending Approval Requests
                  </h3>
                  <p class="table-subtitle">Review and approve or reject booking requests ({{ pendingBookings().length}} total)</p>
                </div>
                <div class="table-container">
                  <div class="table-scroll">
                    <table class="bookings-table">
                      <thead>
                        <tr>
                          <th><i class="fas fa-user"></i> Guest Name</th>
                          <th><i class="fas fa-building"></i> Apartment</th>
                          <th><i class="fas fa-moon"></i> Nights</th>
                          <th><i class="fas fa-naira-sign"></i> Total</th>
                          <th><i class="fas fa-cog"></i> Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        @for (booking of paginatedPendingBookings(); track booking.id) {
                          @if (booking.guestInfo && booking.bookingDetails && booking.pricing) {
                            <tr class="table-row">
                              <td>
                                <div class="guest-cell">
                                  <div class="guest-avatar">
                                    <i class="fas fa-user-circle"></i>
                                  </div>
                                  <div class="guest-info">
                                    <span class="guest-name">{{ booking.guestInfo.name }}</span>
                                    <span class="guest-email">{{ booking.guestInfo.email }}</span>
                                  </div>
                                </div>
                              </td>
                              <td>
                                <span class="apartment-badge">
                                  <i class="fas fa-building"></i>
                                  Apartment {{ getApartmentNumber(booking.apartmentId) }}
                                </span>
                              </td>
                              <td>
                                <span class="nights-badge">
                                  <i class="fas fa-moon"></i>
                                  {{ booking.bookingDetails.numberOfNights }}
                                </span>
                              </td>
                              <td>
                                <span class="price-cell">
                                  ₦{{ booking.pricing.totalPrice | number:'1.0-0' }}
                                </span>
                              </td>
                              <td>
                                <div class="action-buttons">
                                  <button 
                                    class="btn-icon btn-success"
                                    (click)="openApprovalModal(booking, 'approve')"
                                    title="Approve booking"
                                  >
                                    <i class="fas fa-check"></i>
                                  </button>
                                  <button 
                                    class="btn-icon btn-danger"
                                    (click)="openApprovalModal(booking, 'reject')"
                                    title="Reject booking"
                                  >
                                    <i class="fas fa-times"></i>
                                  </button>
                                </div>
                              </td>
                            </tr>
                          }
                        }
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- Pagination -->
                <div class="pagination-container">
                  <div class="pagination-info">
                    Showing {{ ((pendingPage() - 1) * itemsPerPage) + 1 }} to {{ Math.min(pendingPage() * itemsPerPage, pendingBookings().length) }} of {{ pendingBookings().length }} entries
                  </div>
                  @if (pendingTotalPages() > 1) {
                    <div class="pagination-controls">
                      <button 
                        class="pagination-btn"
                        [disabled]="pendingPage() === 1"
                        (click)="previousPendingPage()"
                      >
                        <i class="fas fa-chevron-left"></i>
                        <span>Previous</span>
                      </button>
                      <div class="pagination-pages">
                        @for (page of [].constructor(pendingTotalPages()); track $index) {
                          <button
                            class="pagination-page"
                            [class.active]="$index + 1 === pendingPage()"
                            (click)="goToPendingPage($index + 1)"
                          >
                            {{ $index + 1 }}
                          </button>
                        }
                      </div>
                      <button 
                        class="pagination-btn"
                        [disabled]="pendingPage() === pendingTotalPages()"
                        (click)="nextPendingPage()"
                      >
                        <span>Next</span>
                        <i class="fas fa-chevron-right"></i>
                      </button>
                    </div>
                  }
                </div>
              </div>
            } @else {
              <div class="empty-state">
                <div class="empty-icon success">
                  <i class="fas fa-check-circle"></i>
                </div>
                <h3 class="empty-title">All Caught Up!</h3>
                <p class="empty-text">There are no pending booking requests at the moment. New bookings will appear here for your review.</p>
              </div>
            }
          }

          <!-- All Bookings Tab -->
          @else if (activeTab() === 'all') {
            @if (allBookings().length > 0) {
              <div class="table-wrapper">
                <div class="table-header">
                  <h3 class="table-title">
                    <i class="fas fa-list-alt"></i>
                    All Bookings
                  </h3>
                  <p class="table-subtitle">Complete list of all booking requests ({{ allBookings().length }} total)</p>
                </div>
                <div class="table-container">
                  <div class="table-scroll">
                    <table class="bookings-table">
                      <thead>
                        <tr>
                          <th><i class="fas fa-user"></i> Guest Name</th>
                          <th><i class="fas fa-bed"></i> Booking Option</th>
                          <th><i class="fas fa-moon"></i> Nights</th>
                          <th><i class="fas fa-naira-sign"></i> Total</th>
                          <th><i class="fas fa-info-circle"></i> Status</th>
                          <th><i class="fas fa-cog"></i> Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        @for (booking of paginatedAllBookings(); track booking.id) {
                          @if (booking.guestInfo && booking.bookingDetails && booking.pricing) {
                            <tr class="table-row">
                              <td>
                                <div class="guest-cell">
                                  <div class="guest-avatar">
                                    <i class="fas fa-user-circle"></i>
                                  </div>
                                  <div class="guest-info">
                                    <span class="guest-name">{{ booking.guestInfo.name }}</span>
                                    <span class="guest-email">{{ booking.guestInfo.email }}</span>
                                  </div>
                                </div>
                              </td>
                              <td>
                                <span class="booking-option-badge" [class.one-room]="booking.bookingDetails.bookingOption === 'one-room'" [class.entire-apartment]="booking.bookingDetails.bookingOption === 'entire-apartment'">
                                  <i [class]="booking.bookingDetails.bookingOption === 'one-room' ? 'fas fa-bed' : 'fas fa-home'"></i>
                                  {{ booking.bookingDetails.bookingOption === 'one-room' ? 'One Room' : 'Entire Apartment' }}
                                </span>
                              </td>
                              <td>
                                <span class="nights-badge">
                                  <i class="fas fa-moon"></i>
                                  {{ booking.bookingDetails.numberOfNights }}
                                </span>
                              </td>
                              <td>
                                <span class="price-cell">
                                  ₦{{ booking.pricing.totalPrice | number:'1.0-0' }}
                                </span>
                              </td>
                              <td>
                                <span 
                                  class="status-badge"
                                  [class]="'status-' + booking.status"
                                >
                                  <i [class]="getStatusIcon(booking.status)"></i>
                                  {{ booking.status }}
                                </span>
                              </td>
                              <td>
                                <div class="action-buttons">
                                  <button 
                                    class="btn-icon btn-view"
                                    (click)="viewBookingDetails(booking)"
                                    title="View booking details"
                                  >
                                    <i class="fas fa-eye"></i>
                                  </button>
                                </div>
                              </td>
                            </tr>
                          }
                        }
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- Pagination -->
                <div class="pagination-container">
                  <div class="pagination-info">
                    Showing {{ ((allBookingsPage() - 1) * itemsPerPage) + 1 }} to {{ Math.min(allBookingsPage() * itemsPerPage, allBookings().length) }} of {{ allBookings().length }} entries
                  </div>
                  @if (allBookingsTotalPages() > 1) {
                    <div class="pagination-controls">
                      <button 
                        class="pagination-btn"
                        [disabled]="allBookingsPage() === 1"
                        (click)="previousAllBookingsPage()"
                      >
                        <i class="fas fa-chevron-left"></i>
                        <span>Previous</span>
                      </button>
                      <div class="pagination-pages">
                        @for (page of [].constructor(allBookingsTotalPages()); track $index) {
                          <button
                            class="pagination-page"
                            [class.active]="$index + 1 === allBookingsPage()"
                            (click)="goToAllBookingsPage($index + 1)"
                          >
                            {{ $index + 1 }}
                          </button>
                        }
                      </div>
                      <button 
                        class="pagination-btn"
                        [disabled]="allBookingsPage() === allBookingsTotalPages()"
                        (click)="nextAllBookingsPage()"
                      >
                        <span>Next</span>
                        <i class="fas fa-chevron-right"></i>
                      </button>
                    </div>
                  }
                </div>
              </div>
            } @else {
              <div class="empty-state">
                <div class="empty-icon info">
                  <i class="fas fa-inbox"></i>
                </div>
                <h3 class="empty-title">No Bookings Yet</h3>
                <p class="empty-text">There are no bookings in the system yet. Once guests start booking, they will appear here.</p>
              </div>
            }
          }

          <!-- Activity History Tab -->
          @else if (activeTab() === 'history') {
            @if (adminActions().length > 0) {
              <div class="activity-wrapper">
                <div class="activity-header">
                  <h3 class="activity-title">
                    <i class="fas fa-history"></i>
                    Recent Activity
                  </h3>
                  <p class="activity-subtitle">Track all administrative actions ({{ adminActions().length }} total)</p>
                </div>
                <div class="activity-list">
                  @for (action of paginatedAdminActions(); track action.id; let i = $index) {
                    <div class="activity-item" appAnimateOnScroll="slide-right" [delay]="i * 50">
                      <div class="activity-timeline">
                        <div class="timeline-dot" [class]="'dot-' + action.action"></div>
                        <div class="timeline-line"></div>
                      </div>
                      <div class="activity-card">
                        <div class="activity-icon-badge" [class]="'badge-' + action.action">
                          <i [class]="getActionIconClass(action.action)"></i>
                        </div>
                        <div class="activity-content">
                          <p class="activity-action-title">
                            {{ getActionDescription(action) }}
                          </p>
                          <div class="activity-meta">
                            <span class="meta-item">
                              <i class="fas fa-user-shield"></i>
                              {{ action.adminName }}
                            </span>
                            <span class="meta-divider">•</span>
                            <span class="meta-item">
                              <i class="fas fa-clock"></i>
                              {{ action.timestamp | date:'MMM d, y - h:mm a' }}
                            </span>
                          </div>
                          @if (action.details.notes) {
                            <div class="activity-notes">
                              <i class="fas fa-sticky-note"></i>
                              {{ action.details.notes }}
                            </div>
                          }
                        </div>
                      </div>
                    </div>
                  }
                </div>

                <!-- Pagination -->
                @if (activityTotalPages() > 1) {
                  <div class="pagination-container">
                    <div class="pagination-info">
                      Showing {{ ((activityPage() - 1) * itemsPerPage) + 1 }} to {{ Math.min(activityPage() * itemsPerPage, adminActions().length) }} of {{ adminActions().length }} entries
                    </div>
                    <div class="pagination-controls">
                      <button 
                        class="pagination-btn"
                        [disabled]="activityPage() === 1"
                        (click)="previousActivityPage()"
                      >
                        <i class="fas fa-chevron-left"></i>
                        Previous
                      </button>
                      <div class="pagination-pages">
                        @for (page of [].constructor(activityTotalPages()); track $index) {
                          <button
                            class="pagination-page"
                            [class.active]="$index + 1 === activityPage()"
                            (click)="goToActivityPage($index + 1)"
                          >
                            {{ $index + 1 }}
                          </button>
                        }
                      </div>
                      <button 
                        class="pagination-btn"
                        [disabled]="activityPage() === activityTotalPages()"
                        (click)="nextActivityPage()"
                      >
                        Next
                        <i class="fas fa-chevron-right"></i>
                      </button>
                    </div>
                  </div>
                }
              </div>
            } @else {
              <div class="empty-state">
                <div class="empty-icon info">
                  <i class="fas fa-clipboard-list"></i>
                </div>
                <h3 class="empty-title">No Activity Yet</h3>
                <p class="empty-text">There is no activity history to display. Actions will appear here once performed.</p>
              </div>
            }
          }

          <!-- Manage Listing Tab -->
          @else if (activeTab() === 'listings') {
            <div class="listings-wrapper">
              <div class="listings-header">
                <h3 class="listings-title">
                  <i class="fas fa-home"></i>
                  Manage Apartments
                </h3>
                <p class="listings-subtitle">
                  {{ isEditMode() ? 'Editing apartment details' : 'Add new apartment or edit existing listings' }}
                </p>
              </div>

              <!-- Add New Apartment Button (shown when form is hidden) -->
              @if (!showApartmentForm() && apartments().length > 0) {
                <div class="add-apartment-section">
                  <button class="btn btn-primary" (click)="showAddApartmentForm()">
                    <i class="fas fa-plus"></i>
                    Add New Apartment
                  </button>
                </div>
              }

              <!-- Apartment List -->
              @if (apartments().length > 0) {
                <div class="apartments-list-section">
                  <div class="section-header">
                    <h4 class="section-title">
                      <i class="fas fa-building"></i>
                      Your Apartments ({{ apartments().length }})
                    </h4>
                    @if (isEditMode()) {
                      <button class="btn btn-sm btn-outline" (click)="resetListingForm()">
                        <i class="fas fa-plus"></i>
                        Add New Apartment
                      </button>
                    }
                  </div>
                  <div class="apartments-grid">
                    @for (apartment of apartments(); track apartment.id) {
                      <div class="apartment-card" [class.editing]="editingApartmentId() === apartment.id">
                        <div class="apartment-header">
                          <h5 class="apartment-title">{{ apartment.title }}</h5>
                          <div class="apartment-status-badge" [class.available]="apartment.availability.isAvailable" [class.unavailable]="!apartment.availability.isAvailable">
                            <span class="status-indicator"></span>
                            {{ apartment.availability.isAvailable ? 'Available' : 'Unavailable' }}
                          </div>
                        </div>
                        <div class="apartment-location">
                          <i class="fas fa-map-marker-alt"></i>
                          {{ apartment.location.address }}, {{ apartment.location.city }}
                        </div>
                        <div class="apartment-pricing">
                          <div class="price-item">
                            <span class="price-label">One Room:</span>
                            <span class="price-value">₦{{ apartment.pricing.oneRoomPrice | number:'1.0-0' }}/night</span>
                          </div>
                          <div class="price-item">
                            <span class="price-label">Entire Apartment:</span>
                            <span class="price-value">₦{{ apartment.pricing.entireApartmentPrice | number:'1.0-0' }}/night</span>
                          </div>
                        </div>
                        <div class="apartment-specs">
                          <span class="spec-item">
                            <i class="fas fa-bed"></i>
                            {{ apartment.specifications.bedrooms }} Bed{{ apartment.specifications.bedrooms > 1 ? 's' : '' }}
                          </span>
                          <span class="spec-item">
                            <i class="fas fa-bath"></i>
                            {{ apartment.specifications.bathrooms }} Bath{{ apartment.specifications.bathrooms > 1 ? 's' : '' }}
                          </span>
                          <span class="spec-item">
                            <i class="fas fa-users"></i>
                            Up to {{ apartment.specifications.maxGuestsEntireApartment }} guests
                          </span>
                        </div>
                        <div class="apartment-actions">
                          <button class="btn btn-sm btn-outline" (click)="selectApartmentForEdit(apartment)">
                            <i class="fas fa-edit"></i>
                            Edit
                          </button>
                          <button class="btn btn-sm btn-danger" (click)="deleteApartment(apartment.id!, apartment.title)">
                            <i class="fas fa-trash"></i>
                            Delete
                          </button>
                        </div>
                      </div>
                    }
                  </div>
                </div>
              }

              @if (isLoadingListing()) {
                <div class="loading-container">
                  <app-loader />
                </div>
              } @else if (showApartmentForm()) {
                <div class="listing-form-container">
                  <div class="form-header">
                    <h4 class="form-title">
                      @if (isEditMode()) {
                        <i class="fas fa-edit"></i>
                        Edit Apartment Details
                      } @else {
                        <i class="fas fa-plus-circle"></i>
                        Add New Apartment
                      }
                    </h4>
                    <button class="btn btn-sm btn-outline" (click)="resetListingForm()">
                      <i class="fas fa-times"></i>
                      {{ isEditMode() ? 'Cancel Edit' : 'Close Form' }}
                    </button>
                  </div>

                  <form class="listing-form">
                    <!-- Basic Information Section -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-info-circle"></i>
                        Basic Information
                      </h4>
                      
                      <div class="form-group">
                        <label for="title" class="form-label">Property Title</label>
                        <input
                          type="text"
                          id="title"
                          class="form-input"
                          [(ngModel)]="listingData.title"
                          name="title"
                          placeholder="e.g., Luxurious 2-Bedroom Apartment in Victoria Island"
                          required
                        />
                      </div>

                      <div class="form-group">
                        <label for="description" class="form-label">Description</label>
                        <textarea
                          id="description"
                          class="form-textarea"
                          [(ngModel)]="listingData.description"
                          name="description"
                          rows="5"
                          placeholder="Describe your property, highlight key features, amenities, and what makes it special..."
                          required
                        ></textarea>
                      </div>
                    </div>

                    <!-- Specifications Section -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-home"></i>
                        Property Specifications
                      </h4>
                      
                      <div class="form-row">
                        <div class="form-group">
                          <label for="bedrooms" class="form-label">Bedrooms</label>
                          <input
                            type="number"
                            id="bedrooms"
                            class="form-input"
                            [(ngModel)]="listingData.specifications!.bedrooms"
                            name="bedrooms"
                            min="1"
                            placeholder="1"
                            required
                          />
                        </div>

                        <div class="form-group">
                          <label for="bathrooms" class="form-label">Bathrooms</label>
                          <input
                            type="number"
                            id="bathrooms"
                            class="form-input"
                            [(ngModel)]="listingData.specifications!.bathrooms"
                            name="bathrooms"
                            min="1"
                            placeholder="1"
                            required
                          />
                        </div>
                      </div>

                      <div class="form-row">
                        <div class="form-group">
                          <label for="maxGuestsOneRoom" class="form-label">Max Guests (One Room)</label>
                          <input
                            type="number"
                            id="maxGuestsOneRoom"
                            class="form-input"
                            [(ngModel)]="listingData.specifications!.maxGuestsOneRoom"
                            name="maxGuestsOneRoom"
                            min="1"
                            placeholder="4"
                            required
                          />
                        </div>

                        <div class="form-group">
                          <label for="maxGuestsEntireApartment" class="form-label">Max Guests (Entire Apartment)</label>
                          <input
                            type="number"
                            id="maxGuestsEntireApartment"
                            class="form-input"
                            [(ngModel)]="listingData.specifications!.maxGuestsEntireApartment"
                            name="maxGuestsEntireApartment"
                            min="1"
                            placeholder="5"
                            required
                          />
                        </div>
                      </div>
                    </div>

                    <!-- Pricing Section -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-naira-sign"></i>
                        Pricing
                      </h4>
                      
                      <div class="form-row">
                        <div class="form-group">
                          <label for="priceOneRoom" class="form-label">One Room Price (per night)</label>
                          <div class="input-group">
                            <span class="input-prefix">₦</span>
                            <input
                              type="number"
                              id="priceOneRoom"
                              class="form-input"
                              [(ngModel)]="listingData.pricing!.oneRoomPrice"
                              name="priceOneRoom"
                              min="0"
                              step="1"
                              placeholder="25000"
                              required
                            />
                          </div>
                        </div>

                        <div class="form-group">
                          <label for="priceEntireApartment" class="form-label">Entire Apartment Price (per night)</label>
                          <div class="input-group">
                            <span class="input-prefix">₦</span>
                            <input
                              type="number"
                              id="priceEntireApartment"
                              class="form-input"
                              [(ngModel)]="listingData.pricing!.entireApartmentPrice"
                              name="priceEntireApartment"
                              min="0"
                              step="1"
                              placeholder="45000"
                              required
                            />
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Amenities Section -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-list-check"></i>
                        Amenities & Features
                      </h4>
                      
                      <div class="form-group">
                        <label for="amenities" class="form-label">Amenities (one per line)</label>
                        <textarea
                          id="amenities"
                          class="form-textarea"
                          [(ngModel)]="amenitiesText"
                          name="amenities"
                          rows="6"
                          placeholder="WiFi&#10;Air Conditioning&#10;Fully Equipped Kitchen&#10;24/7 Security&#10;Private Parking&#10;Smart TV"
                        ></textarea>
                        <small class="form-hint">Enter each amenity on a new line</small>
                      </div>
                    </div>

                    <!-- Images Section (Optional - Storage Disabled) -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-images"></i>
                        Property Images (Optional)
                      </h4>
                      
                      <div class="form-group">
                        <label for="images" class="form-label">Image URLs (one per line)</label>
                        <textarea
                          id="images"
                          class="form-textarea"
                          [(ngModel)]="imagesText"
                          name="images"
                          rows="4"
                          placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg&#10;https://example.com/image3.jpg"
                        ></textarea>
                        <small class="form-hint">
                          <i class="fas fa-info-circle"></i>
                          Enter each image URL on a new line. Image upload from device is disabled (Firebase Storage not configured).
                        </small>
                      </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-map-marker-alt"></i>
                        Location
                      </h4>
                      
                      <div class="form-group">
                        <label for="address" class="form-label">Full Address</label>
                        <input
                          type="text"
                          id="address"
                          class="form-input"
                          [(ngModel)]="listingData.location!.address"
                          name="address"
                          placeholder="e.g., 123 Akin Adesola Street, Victoria Island, Lagos"
                          required
                        />
                      </div>

                      <div class="form-row">
                        <div class="form-group">
                          <label for="city" class="form-label">City</label>
                          <input
                            type="text"
                            id="city"
                            class="form-input"
                            [(ngModel)]="listingData.location!.city"
                            name="city"
                            placeholder="Lagos"
                            required
                          />
                        </div>

                        <div class="form-group">
                          <label for="state" class="form-label">State</label>
                          <input
                            type="text"
                            id="state"
                            class="form-input"
                            [(ngModel)]="listingData.location!.state"
                            name="state"
                            placeholder="Lagos"
                            required
                          />
                        </div>
                      </div>
                      
                      <div class="form-group">
                        <label for="country" class="form-label">Country</label>
                        <input
                          type="text"
                          id="country"
                          class="form-input"
                          [(ngModel)]="listingData.location!.country"
                          name="country"
                          placeholder="Nigeria"
                          required
                        />
                      </div>
                    </div>

                    <!-- Additional Details Section -->
                    <div class="form-section">
                      <h4 class="section-title">
                        <i class="fas fa-star"></i>
                        Additional Details (Optional)
                      </h4>
                      
                      <div class="form-row">
                        <div class="form-group">
                          <label for="floors" class="form-label">Number of Floors</label>
                          <input
                            type="number"
                            id="floors"
                            class="form-input"
                            [(ngModel)]="listingData.specifications!.floors"
                            name="floors"
                            min="1"
                            placeholder="1"
                          />
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          <input
                            type="checkbox"
                            [(ngModel)]="listingData.featured"
                            name="featured"
                            style="margin-right: 0.5rem;"
                          />
                          Featured Listing (Show prominently on homepage)
                        </label>
                      </div>
                    </div>

                    <!-- Save Button -->
                    <div class="form-actions">
                      <button
                        type="button"
                        class="btn btn-save"
                        [disabled]="isSavingListing()"
                        (click)="saveListing()"
                      >
                        @if (isSavingListing()) {
                          <i class="fas fa-spinner fa-spin"></i>
                          <span>{{ isEditMode() ? 'Updating...' : 'Saving...' }}</span>
                        } @else {
                          <i class="fas fa-save"></i>
                          <span>{{ isEditMode() ? 'Update Apartment' : 'Add Apartment' }}</span>
                        }
                      </button>

                      @if (listingSaveSuccess()) {
                        <div class="save-success">
                          <i class="fas fa-check-circle"></i>
                          <span>{{ isEditMode() ? 'Updated successfully!' : 'Added successfully!' }}</span>
                        </div>
                      }
                    </div>
                  </form>
                </div>
              } @else if (apartments().length === 0 && !showApartmentForm()) {
                <!-- Empty State: No apartments yet -->
                <div class="empty-state-box">
                  <div class="empty-icon">
                    <i class="fas fa-building"></i>
                  </div>
                  <h4 class="empty-title">No Apartments Yet</h4>
                  <p class="empty-message">Get started by adding your first apartment listing</p>
                  <button class="btn btn-primary" (click)="showAddApartmentForm()">
                    <i class="fas fa-plus"></i>
                    Add Your First Apartment
                  </button>
                </div>
              }
            </div>
          }
        </div>
      </div>

      <!-- Approval Modal -->
      <app-modal
        #approvalModal
        [size]="'md'"
        [showFooter]="true"
        [showDefaultButtons]="true"
        [confirmText]="approvalAction() === 'approve' ? 'Approve' : 'Reject'"
        (modalClose)="closeApprovalModal()"
        (modalConfirm)="confirmApproval()"
      >
        @if (selectedBooking()) {
          <div class="approval-content">
            <p class="approval-question">
              Are you sure you want to {{ approvalAction() }} this booking?
            </p>
            
            @if (selectedBooking()!.guestInfo && selectedBooking()!.bookingDetails && selectedBooking()!.pricing) {
              <div class="booking-details">
                <div class="detail-row">
                  <span class="detail-label">Guest:</span>
                  <span class="detail-value">{{ selectedBooking()!.guestInfo.name }}</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">Booking Option:</span>
                  <span class="detail-value">{{ selectedBooking()!.bookingDetails.bookingOption === 'one-room' ? 'One Room' : 'Entire Apartment' }}</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">Check-in:</span>
                  <span class="detail-value">{{ selectedBooking()!.bookingDetails.checkInDate | date }}</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">Total:</span>
                  <span class="detail-value">
                    ₦{{ selectedBooking()!.pricing.totalPrice | number:'1.0-0' }}
                  </span>
                </div>
              </div>
            } @else {
              <p class="text-warning">⚠️ Incomplete booking data. Please check the database.</p>
            }

            @if (approvalAction() === 'reject') {
              <div class="form-group">
                <label for="reason" class="form-label">Reason for rejection:</label>
                <textarea
                  id="reason"
                  name="rejectionReason"
                  [(ngModel)]="rejectionReason"
                  class="form-control"
                  rows="3"
                  placeholder="Enter reason for rejection..."
                ></textarea>
              </div>
            }
          </div>
        }
      </app-modal>

      <!-- Booking Details Modal -->
      <app-modal
        #detailsModal
        [size]="'lg'"
        (modalClose)="closeDetailsModal()"
      >
        @if (selectedBooking()) {
          @if (selectedBooking()!.guestInfo && selectedBooking()!.bookingDetails && selectedBooking()!.pricing) {
            <div class="details-content">
              <h3 class="details-heading">Guest Information</h3>
              <div class="details-grid">
                <div class="detail-item">
                  <span class="detail-label">Name:</span>
                  <span class="detail-value">{{ selectedBooking()!.guestInfo.name }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Email:</span>
                  <span class="detail-value">{{ selectedBooking()!.guestInfo.email }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Phone:</span>
                  <span class="detail-value">{{ selectedBooking()!.guestInfo.phone }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Address:</span>
                  <span class="detail-value">{{ selectedBooking()!.guestInfo.address }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Number of Guests:</span>
                  <span class="detail-value">{{ selectedBooking()!.bookingDetails.numberOfGuests }}</span>
                </div>
              </div>

              <h3 class="details-heading">Booking Information</h3>
              <div class="details-grid">
                <div class="detail-item">
                  <span class="detail-label">Booking Option:</span>
                  <span class="booking-option-badge" [class.one-room]="selectedBooking()!.bookingDetails.bookingOption === 'one-room'" [class.entire-apartment]="selectedBooking()!.bookingDetails.bookingOption === 'entire-apartment'">
                    <i [class]="selectedBooking()!.bookingDetails.bookingOption === 'one-room' ? 'fas fa-bed' : 'fas fa-home'"></i>
                    {{ selectedBooking()!.bookingDetails.bookingOption === 'one-room' ? 'One Room' : 'Entire Apartment' }}
                  </span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Check-in:</span>
                  <span class="detail-value">{{ selectedBooking()!.bookingDetails.checkInDate | date:'MMM d, y' }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Check-out:</span>
                  <span class="detail-value">{{ selectedBooking()!.bookingDetails.checkOutDate | date:'MMM d, y' }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Nights:</span>
                  <span class="nights-badge">
                    <i class="fas fa-moon"></i>
                    {{ selectedBooking()!.bookingDetails.numberOfNights }}
                  </span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Status:</span>
                  <span class="status-badge" [class]="'status-' + selectedBooking()!.status">
                    <i [class]="getStatusIcon(selectedBooking()!.status)"></i>
                    {{ selectedBooking()!.status }}
                  </span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Price per Night:</span>
                  <span class="detail-value">₦{{ selectedBooking()!.pricing.pricePerNight | number:'1.0-0' }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Total Price:</span>
                  <span class="detail-value price-highlight">
                    ₦{{ selectedBooking()!.pricing.totalPrice | number:'1.0-0' }}
                  </span>
                </div>
              </div>

              @if (selectedBooking()!.guestInfo.idPhotoUrl) {
                <h3 class="details-heading">ID Photo</h3>
                <div class="id-photo-container">
                  <img [src]="selectedBooking()!.guestInfo.idPhotoUrl" alt="Guest ID Photo" class="id-photo">
                </div>
              }

              @if (selectedBooking()!.adminNotes) {
                <h3 class="details-heading">Admin Notes</h3>
                <p class="admin-notes">{{ selectedBooking()!.adminNotes }}</p>
              }
            </div>
          } @else {
            <div class="details-content">
              <p class="text-warning">⚠️ Incomplete booking data. This booking has missing information in the database.</p>
              <p class="text-muted">Booking ID: {{ selectedBooking()!.id }}</p>
            </div>
          }
        }
      </app-modal>

      <!-- Availability Management Modal -->
      <app-modal
        #availabilityModal
        [size]="'md'"
        (modalClose)="closeAvailabilityModal()"
      >
        <div class="availability-modal-content">
          <p class="modal-description">Toggle availability for your apartments. Unavailable apartments will not appear in the booking form.</p>
          
          @if (apartments().length > 0) {
            <div class="apartments-availability-list">
              @for (apartment of apartments(); track apartment.id) {
                <div class="availability-item" [class.unavailable]="!apartment.availability.isAvailable">
                  <div class="apartment-info">
                    <h4 class="apartment-name">{{ apartment.title }}</h4>
                    <p class="apartment-location">
                      <i class="fas fa-map-marker-alt"></i>
                      {{ apartment.location.address }}
                    </p>
                    <span class="availability-badge" 
                          [class.badge-available]="apartment.availability.isAvailable"
                          [class.badge-unavailable]="!apartment.availability.isAvailable">
                      <i [class]="apartment.availability.isAvailable ? 'fas fa-check-circle' : 'fas fa-times-circle'"></i>
                      {{ apartment.availability.isAvailable ? 'Available' : 'Unavailable' }}
                    </span>
                  </div>
                  <button 
                    class="btn-toggle"
                    [class.btn-make-unavailable]="apartment.availability.isAvailable"
                    [class.btn-make-available]="!apartment.availability.isAvailable"
                    [disabled]="isTogglingApartment(apartment.id!)"
                    (click)="toggleApartmentAvailabilityById(apartment.id!, apartment.availability.isAvailable)"
                  >
                    @if (isTogglingApartment(apartment.id!)) {
                      <i class="fas fa-spinner fa-spin"></i>
                    } @else {
                      <i [class]="apartment.availability.isAvailable ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                      {{ apartment.availability.isAvailable ? 'Hide' : 'Show' }}
                    }
                  </button>
                </div>
              }
            </div>
          } @else {
            <div class="empty-state-small">
              <i class="fas fa-home"></i>
              <p>No apartments found. Please add an apartment first.</p>
            </div>
          }
        </div>
      </app-modal>

      <!-- Hide Duration Modal -->
      <app-modal
        #hideDurationModal
        [size]="'md'"
        (modalClose)="closeHideDurationModal()"
      >
        <div class="hide-duration-modal">
          <p class="modal-description">Choose how you want to hide this apartment from the booking page.</p>
          
          <div class="hide-options-container">
            <!-- Option 1: Hide Indefinitely -->
            <div class="hide-option">
              <h4><i class="fas fa-ban"></i> Hide Now</h4>
              <p class="option-description">Hide until manually shown again.</p>
              <button
                class="btn btn-secondary btn-block" style="margin-bottom: 0.5rem;"
                (click)="hideApartmentImmediately()"
              >
                <i class="fas fa-eye-slash"></i> Hide Now
              </button>
            </div>

            <div class="option-divider">
              <span>OR</span>
            </div>

            <!-- Option 2: Hide for Duration -->
            <div class="hide-option">
              <h4><i class="fas fa-clock"></i> Set Duration</h4>
              <p class="option-description">Auto-show after specified days.</p>
              
              <div class="duration-form">
                <div class="form-group">
                  <label for="hideDays">Number of Days</label>
                  <input
                    type="number"
                    id="hideDays"
                    class="form-control"
                    [ngModel]="hideDurationDays()"
                    (ngModelChange)="hideDurationDays.set($event)"
                    min="1"
                    max="365"
                    placeholder="Enter days (1-365)"
                  />
                  @if (hideDurationDays() > 0) {
                    <small class="form-text">
                      <i class="fas fa-calendar-check"></i> 
                      Will become available again on: <strong>{{ calculateHiddenUntilDate() }}</strong>
                    </small>
                  }
                </div>

                <div class="form-group">
                  <label for="hideReason">Reason (Optional)</label>
                  <input
                    type="text"
                    id="hideReason"
                    class="form-control"
                    [ngModel]="hideReason()"
                    (ngModelChange)="hideReason.set($event)"
                    placeholder="e.g., Maintenance, Renovation, Cleaning"
                  />
                </div>

                <button
                  class="btn btn-primary btn-block" style="margin-top: 1rem; margin-bottom: 1rem;"
                  [disabled]="hideDurationDays() < 1 || hideDurationDays() > 365"
                  (click)="hideApartmentForDuration()"
                >
                  <i class="fas fa-clock"></i> Hide for {{ hideDurationDays() }} {{ hideDurationDays() === 1 ? 'Day' : 'Days' }}
                </button>
              </div>
            </div>
          </div>

          <button class="btn btn-outline btn-block mt-3" (click)="closeHideDurationModal()">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </app-modal>

      <!-- Logout Confirmation Modal -->
      <app-modal
        #logoutModal
        [size]="'sm'"
        (modalClose)="closeLogoutModal()"
      >
        <div class="logout-modal-content">
          <div class="logout-icon">
            <i class="fas fa-sign-out-alt"></i>
          </div>
          <h3 class="logout-title">Sign Out?</h3>
          <p class="logout-message">
            Are you sure you want to sign out of the admin portal?
          </p>
          <div class="logout-actions">
            <button class="btn btn-outline" (click)="closeLogoutModal()">
              <i class="fas fa-times"></i>
              Cancel
            </button>
            <button class="btn btn-danger" (click)="confirmLogout()">
              <i class="fas fa-sign-out-alt"></i>
              Sign Out
            </button>
          </div>
        </div>
      </app-modal>
    </div>
